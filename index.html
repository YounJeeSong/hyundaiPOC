<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로젝트 조회 - 현대자동차 R&D Parameter DB</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Sans KR', sans-serif; background: #f6f3f2; }
        .app-container { display: flex; height: 100vh; overflow: hidden; }
        
        /* Navigation Reset */
        .global-nav, .global-nav * {
            font-weight: 400 !important;
            letter-spacing: 0 !important;
            line-height: 1.5 !important;
            -webkit-font-smoothing: subpixel-antialiased !important;
        }
        
        .global-nav { width: 240px; background: #002c5f; color: #fff; display: flex; flex-direction: column; flex-shrink: 0; }
        .logo-area { padding: 24px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .logo-title { font-size: 20px; font-weight: 500; }
        .logo-subtitle { font-size: 14px; opacity: 0.7; margin-top: 4px; }
        .nav-menu { flex: 1; padding: 16px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; color: #fff; font-size: 14px; border-radius: 4px; cursor: pointer; transition: 0.3s ease; margin-bottom: 4px; }
        .nav-item:hover { background: rgba(255, 255, 255, 0.1); }
        .nav-item.active { background: #00aad2; }
        
        .main-content { flex: 1; display: flex; flex-direction: column; }
        .top-bar { height: 70px; background: #fff; border-bottom: 1px solid #e4dcd3; display: flex; align-items: center; justify-content: space-between; padding: 0 32px; }
        .page-title { font-size: 24px; font-weight: 500; color: #002c5f; }
        .btn { padding: 12px 24px; border: 1px solid #e4dcd3; border-radius: 4px; font-size: 14px; cursor: pointer; }
        .btn-primary { background: #002c5f; color: #fff; border: none; }
        .content-area { flex: 1; overflow-y: auto; padding: 32px; }
        .project-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; }
        
        .project-card { background: #fff; border: 1px solid #e4dcd3; border-radius: 8px; overflow: hidden; transition: 0.2s; position: relative; }
        .project-card:hover { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); transform: translateY(-2px); }
        .project-card-preview { height: 180px; background: #f6f3f2; display: flex; align-items: center; justify-content: center; position: relative; }
        .project-card-preview img { width: 100%; height: 100%; object-fit: contain; }
        .project-card-category { position: absolute; top: 12px; left: 12px; padding: 4px 12px; background: #002c5f; color: #fff; font-size: 12px; border-radius: 12px; }
        .project-card-body { padding: 16px; }
        .project-card-title { font-size: 16px; font-weight: 500; color: #002c5f; margin-bottom: 8px; }
        .project-card-info { font-size: 14px; color: #676767; margin-bottom: 12px; }
        .project-card-description { font-size: 14px; color: #676767; margin-bottom: 12px; min-height: 2.8em; }
        .project-card-footer { display: flex; justify-content: space-between; padding-top: 12px; border-top: 1px solid #e4dcd3; }
        .project-card-date { font-size: 12px; color: #676767; }
        
        /* 호버 오버레이 */
        .project-card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 44, 95, 0.85);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }
        .project-card:hover .project-card-overlay {
            opacity: 1;
            pointer-events: auto;
        }
        .overlay-btn {
            padding: 10px 32px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            min-width: 120px;
            transition: 0.2s;
        }
        .overlay-btn-open {
            background: #00aad2;
            color: #fff;
        }
        .overlay-btn-open:hover { background: #008fb3; }
        .overlay-btn-delete {
            background: transparent;
            color: #fff;
            border: 1px solid rgba(255,255,255,0.5);
        }
        .overlay-btn-delete:hover { background: rgba(255,255,255,0.1); border-color: #fff; }
    </style>
</head>
<body>
    <div class="app-container">
        <nav class="global-nav">
            <div class="logo-area">
                <div class="logo-title">R&D Parameter DB</div>
                <div class="logo-subtitle">현대자동차</div>
            </div>
            <div class="nav-menu">
                <div class="nav-item active" onclick="location.href='index.html'">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                        <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                    </svg>
                    데이터조회
                </div>
                <div class="nav-item" onclick="location.href='create-step1.html'">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                    </svg>
                    데이터 생성
                </div>
                <div class="nav-item" onclick="location.href='kpi-analysis.html'">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                    </svg>
                    해석
                </div>
                <div class="nav-item" onclick="location.href='simulation-setup.html'">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
                    </svg>
                    시뮬레이션
                </div>
            </div>
        </nav>
        <div class="main-content">
            <div class="top-bar">
                <h1 class="page-title">프로젝트 조회</h1>
                <button class="btn btn-primary" onclick="window.location.href='create-step1.html'">+ 새 프로젝트</button>
            </div>
            <div class="content-area">
                <div class="project-grid" id="projectGrid"></div>
            </div>
        </div>
    </div>
    <script>
        const ENGINE_IMAGE = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjZmM2YyIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM2NzY3NjciIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0Ij5Nb2RlbCBJbWFnZTwvdGV4dD48L3N2Zz4=';

        // 더미 프로젝트 데이터
        const dummyProjects = [
            {
                id: 1001,
                name: '2025 GV90 전륜 서스펜션 시스템',
                category: '서스펜션',
                description: '대형 SUV 승차감 최적화를 위한 전륜 서스펜션 파라미터',
                cardCount: 8,
                createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString()
            },
            {
                id: 1002,
                name: 'E-GMP 배터리 냉각 모듈 v2.3',
                category: '배터리',
                description: '고속충전 대응 열관리 시스템 설계 파라미터',
                cardCount: 12,
                createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString()
            },
            {
                id: 1003,
                name: 'IONIQ 7 전동 파워스티어링',
                category: '조향',
                description: 'R-MDPS 조향감 튜닝 및 응답성 파라미터',
                cardCount: 6,
                createdAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString()
            },
            {
                id: 1004,
                name: 'N브랜드 샤시 강성 해석',
                category: '샤시',
                description: '고성능 차량 바디 강성 및 NVH 특성 분석',
                cardCount: 15,
                createdAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()
            },
            {
                id: 1005,
                name: '통합 브레이크 시스템 IDB2',
                category: '제동',
                description: '회생제동 연계 유압제동 파라미터 설정',
                cardCount: 9,
                createdAt: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString()
            },
            {
                id: 1006,
                name: '후륜 멀티링크 지오메트리',
                category: '서스펜션',
                description: '5-Link 후륜 서스펜션 킥백 저감 설계',
                cardCount: 7,
                createdAt: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000).toISOString()
            }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            initSampleData();
        });

        function initSampleData() {
            let projectList = JSON.parse(localStorage.getItem('projectList') || '[]');
            
            if (projectList.length === 0) {
                projectList = dummyProjects.map(p => ({
                    id: p.id,
                    name: p.name,
                    category: p.category,
                    createdAt: p.createdAt,
                    cardCount: p.cardCount
                }));
                
                dummyProjects.forEach(p => {
                    const projectData = {
                        id: p.id,
                        meta: {
                            projectName: p.name,
                            category: p.category,
                            description: p.description,
                            createdAt: p.createdAt,
                            step: 2
                        },
                        cards: [],
                        layout: { modelImageSrc: ENGINE_IMAGE }
                    };
                    localStorage.setItem('project_' + p.id, JSON.stringify(projectData));
                });
                
                localStorage.setItem('projectList', JSON.stringify(projectList));
            }
            
            loadProjects();
        }

        function loadProjects() {
            const projectList = JSON.parse(localStorage.getItem('projectList') || '[]');
            
            const projects = projectList.map(proj => {
                const projectData = JSON.parse(localStorage.getItem('project_' + proj.id) || '{}');
                return {
                    ...proj,
                    description: projectData.meta ? projectData.meta.description : '',
                    modelImageSrc: projectData.layout ? projectData.layout.modelImageSrc : null
                };
            });
            
            renderProjects(projects);
        }

        function renderProjects(projects) {
            const grid = document.getElementById('projectGrid');
            
            grid.innerHTML = projects.map(project => {
                return '<div class="project-card">' +
                    '<div class="project-card-overlay">' +
                        '<button class="overlay-btn overlay-btn-open" onclick="openProject(' + project.id + ')">열기</button>' +
                        '<button class="overlay-btn overlay-btn-delete" onclick="deleteProject(event, ' + project.id + ')">삭제</button>' +
                    '</div>' +
                    '<div class="project-card-preview">' +
                    (project.modelImageSrc ? '<img src="' + project.modelImageSrc + '" alt="' + project.name + '">' : '') +
                    '<div class="project-card-category">' + project.category + '</div>' +
                    '</div>' +
                    '<div class="project-card-body">' +
                    '<div class="project-card-title">' + project.name + '</div>' +
                    '<div class="project-card-info">' + project.cardCount + '개 카드</div>' +
                    '<div class="project-card-description">' + (project.description || '설명 없음') + '</div>' +
                    '<div class="project-card-footer">' +
                    '<div class="project-card-date">' + formatDate(project.createdAt) + '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>';
            }).join('');
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const days = Math.floor((now - date) / (1000 * 60 * 60 * 24));
            if (days === 0) return '오늘';
            if (days === 1) return '어제';
            if (days < 7) return days + '일 전';
            return date.toLocaleDateString('ko-KR');
        }

        function openProject(projectId) {
            window.location.href = 'view-detail.html';
        }

        function deleteProject(event, projectId) {
            event.stopPropagation();
            
            if (confirm('이 프로젝트를 삭제하시겠습니까?')) {
                localStorage.removeItem('project_' + projectId);
                
                let projectList = JSON.parse(localStorage.getItem('projectList') || '[]');
                projectList = projectList.filter(p => p.id !== projectId);
                localStorage.setItem('projectList', JSON.stringify(projectList));
                
                loadProjects();
            }
        }
    </script>
</body>
</html>
